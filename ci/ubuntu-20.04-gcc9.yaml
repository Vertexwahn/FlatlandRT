# GCC9 on Ubuntu 20.04
# Make sure we can build with GCC9 in all different compilation modes

steps:
  - checkout: self
    clean: true
    fetchDepth: 1
    lfs: false
    submodules: false


  - script: |
      echo "deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8" | sudo tee /etc/apt/sources.list.d/bazel.list
      curl https://bazel.build/bazel-release.pub.gpg | sudo apt-key add -
      sudo apt-get update && sudo apt-get install -y bazel
    displayName: 'Install Bazel'

  - script: |
      bazel version
    displayName: 'Show Bazel version'


  - script: |
      cd devertexwahn
      bazel build --config=gcc9  -- //...
    displayName: 'Bazel build gcc9-fastbuild'

  - script: |
      cd devertexwahn
      bazel test --config=gcc9  -- //...
    displayName: 'Bazel test gcc9-fastbuild'

